<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container { margin-top: 30px; }
        .product-image { width: 100px; height: 100px; object-fit: cover; }
        .action-buttons button { margin-right: 5px; }
        .image-preview {
            max-width: 80px; max-height: 80px; margin: 5px;
            border: 1px solid #ddd; padding: 2px; object-fit: cover;
        }
        #image-preview-container-edit { display: flex; flex-wrap: wrap; }
        #existing-images-container {
            display: flex;
            flex-wrap: wrap;
            margin-top: 10px;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        #existing-images-container .img-wrapper {
            margin: 5px;
            border: 1px solid #ddd;
            padding: 5px;
            border-radius: 3px;
            background-color: #fff;
            position: relative;
        }
        #existing-images-container .img-wrapper img {
            max-width: 80px;
            max-height: 80px;
            object-fit: cover;
            display: block;
        }
        #existing-images-container .img-wrapper .buttons-container {
            margin-top: 5px;
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
<div class="container">
    <h1 class="mb-4">–ù–∞—à–∏ —Ç–æ–≤–∞—Ä—ã</h1>
    <div id="error-message" class="alert alert-danger" style="display: none;"></div>
    <div id="success-message" class="alert alert-success" style="display: none;"></div>

    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>–§–æ—Ç–æ</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–ê—Ä—Ç–∏–∫—É–ª</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–ö–æ–ª-–≤–æ</th>
            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
            <th>–ë—Ä–µ–Ω–¥</th>
            <th>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</th>
            <!-- –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –≤ —Ç–∞–±–ª–∏—Ü—É -->
            <th>–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ</th>
            <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
            <th>–í –Ω–∞–ª–∏—á–∏–∏</th>
            <th class="text-center">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody id="product-table-body"></tbody>
    </table>
</div>

<div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editProductModalLabel">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editProductForm" enctype="multipart/form-data">
                    <input type="hidden" id="edit-productId">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                                <input type="text" class="form-control" id="edit-name" required>
                            </div>
                            <div class="mb-3">
                                <label for="edit-articleNumber" class="form-label">–ê—Ä—Ç–∏–∫—É–ª</label>
                                <input type="text" class="form-control" id="edit-articleNumber" required>
                            </div>
                            <div class="mb-3">
                                <label for="edit-price" class="form-label">–¶–µ–Ω–∞</label>
                                <input type="number" step="0.01" class="form-control" id="edit-price" required>
                            </div>
                            <div class="mb-3">
                                <label for="edit-quantity" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
                                <input type="number" class="form-control" id="edit-quantity" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-brand" class="form-label">–ë—Ä–µ–Ω–¥</label>
                                <input type="text" class="form-control" id="edit-brand" required>
                            </div>
                            <div class="mb-3">
                                <label for="edit-category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <input type="text" class="form-control" id="edit-category" required>
                            </div>
                            <div class="mb-3">
                                <label for="edit-manufacturer" class="form-label">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</label>
                                <input type="text" class="form-control" id="edit-manufacturer">
                            </div>
                            <div class="mb-3">
                                <label for="edit-carBrand" class="form-label">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è</label>
                                <input type="text" class="form-control" id="edit-carBrand">
                            </div>
                            <div class="mb-3">
                                <label for="edit-description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea class="form-control" id="edit-description" rows="2"></textarea>
                            </div>
                            <div class="form-check mb-3">
                                <input type="checkbox" class="form-check-input" id="edit-inStock">
                                <label class="form-check-label" for="edit-inStock">–í –Ω–∞–ª–∏—á–∏–∏</label>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <h5>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h5>
                    <div id="existing-images-container" class="mt-2 d-flex flex-wrap"></div>
                    <hr>
                    <div class="mb-3">
                        <label for="edit-files" class="form-label">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ</label>
                        <input type="file" class="form-control" id="edit-files" accept="image/*" multiple>
                        <div id="image-preview-container-edit" class="mt-2"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button type="button" class="btn btn-primary" id="saveChangesBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetchProducts();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–∞–º "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –∏ "–£–¥–∞–ª–∏—Ç—å"
        document.getElementById('product-table-body').addEventListener('click', function(e) {
            const target = e.target.closest('button');
            if (!target) return;

            const productId = target.dataset.id;
            if (target.classList.contains('btn-edit')) {
                handleEdit(productId);
            }
            if (target.classList.contains('btn-delete')) {
                handleDelete(productId);
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        document.getElementById('saveChangesBtn').addEventListener('click', submitEditForm);

        // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–ª—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        document.getElementById('edit-files').addEventListener('change', previewEditImages);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ "–°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–≤—å—é" –∏ "–£–¥–∞–ª–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        document.getElementById('editProductModal').addEventListener('click', async function(e) {
            const target = e.target;
            const productId = document.getElementById('edit-productId').value; // –ü–æ–ª—É—á–∞–µ–º ID –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–∑ —Å–∫—Ä—ã—Ç–æ–≥–æ –ø–æ–ª—è

            if (target.classList.contains('set-preview-btn')) {
                const imageId = target.dataset.imageId;
                if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é?`)) {
                    return;
                }
                try {
                    const response = await fetch(`/api/products/${productId}/images/${imageId}/set-preview`, {
                        method: 'PUT'
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–µ–≤—å—é.');
                    }

                    showMessage('–ü—Ä–µ–≤—å—é —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
                    handleEdit(productId);
                    // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, —á—Ç–æ–±—ã –Ω–æ–≤–æ–µ –ø—Ä–µ–≤—å—é –æ—Ç–æ–±—Ä–∞–∑–∏–ª–æ—Å—å
                    fetchProducts();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–µ–≤—å—é:', error);
                    showMessage(error.message, 'danger');
                }
            }

            if (target.classList.contains('delete-image-btn')) {
                const imageId = target.dataset.imageId;
                if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ?`)) {
                    return;
                }
                try {
                    const response = await fetch(`/api/products/${productId}/images/${imageId}`, {
                        method: 'DELETE'
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.');
                    }

                    showMessage('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ!');
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
                    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
                    target.closest('.img-wrapper').remove();
                    // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–æ –ø—Ä–µ–≤—å—é
                    fetchProducts();
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', error);
                    showMessage(error.message, 'danger');
                }
            }
        });
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
    function showMessage(text, type = 'success') {
        const messageEl = document.getElementById(type === 'success' ? 'success-message' : 'error-message');
        messageEl.textContent = text;
        messageEl.style.display = 'block';
        setTimeout(() => { messageEl.style.display = 'none'; }, 4000);
    }

    async function fetchProducts() {
        try {
            const response = await fetch('/api/products/AllProducts');
            if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${response.statusText}`);

            const products = await response.json();
            const tableBody = document.getElementById('product-table-body');
            tableBody.innerHTML = '';

            products.forEach(product => {
                const row = document.createElement('tr');
                const imageHtml = product.previewImageId
                    ? `<img src="/images/${product.previewImageId}" class="product-image" alt="–§–æ—Ç–æ">`
                    : `<span class="text-muted">–ù–µ—Ç —Ñ–æ—Ç–æ</span>`;

                row.innerHTML = `
                    <td>${product.id}</td>
                    <td>${imageHtml}</td>
                    <td>${product.name}</td>
                    <td>${product.articleNumber}</td>
                    <td>${product.price.toFixed(2)} ‚ÇΩ</td>
                    <td>${product.quantity}</td>
                    <td>${product.category || 'N/A'}</td>
                    <td>${product.brand || 'N/A'}</td>
                    <td>${product.manufacturer || 'N/A'}</td>
                    <!-- –í —Å—Ç—Ä–æ–∫–µ —Ç–æ–≤–∞—Ä–∞ –¥–æ–±–∞–≤—å—Ç–µ -->
                    <td>${product.carBrand || 'N/A'}</td>
                    <td>${product.description ? product.description.substring(0, 50) + '...' : 'N/A'}</td>
                    <td>${product.inStock ? '‚úîÔ∏è' : '‚ùå'}</td>
                    <td class="text-center action-buttons">
                        <button class="btn btn-sm btn-primary btn-edit" data-id="${product.id}">‚úèÔ∏è</button>
                        <button class="btn btn-sm btn-danger btn-delete" data-id="${product.id}">üóëÔ∏è</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤: ' + error.message, 'danger');
        }
    }

    // ----- –õ–û–ì–ò–ö–ê –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø -----
    let editModal;
    async function handleEdit(id) {
        if (!editModal) {
            editModal = new bootstrap.Modal(document.getElementById('editProductModal'));
        }

        try {
            const response = await fetch(`/api/products/${id}`);
            if (!response.ok) throw new Error('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
            const product = await response.json();

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('edit-productId').value = product.id;
            document.getElementById('edit-name').value = product.name;
            document.getElementById('edit-articleNumber').value = product.articleNumber;
            document.getElementById('edit-price').value = product.price;
            document.getElementById('edit-quantity').value = product.quantity;
            document.getElementById('edit-brand').value = product.brand || '';
            document.getElementById('edit-category').value = product.category || '';
            document.getElementById('edit-manufacturer').value = product.manufacturer || '';
            document.getElementById('edit-carBrand').value = product.carBrand || '';
            document.getElementById('edit-description').value = product.description || '';
            document.getElementById('edit-inStock').checked = product.inStock;

            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–µ–≤—å—é –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ–ª–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
            document.getElementById('image-preview-container-edit').innerHTML = '';
            document.getElementById('edit-files').value = '';

            // –ö–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            const existingImagesContainer = document.getElementById('existing-images-container');
            existingImagesContainer.innerHTML = ''; // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º

            if (product.images && product.images.length > 0) {
                product.images.forEach(image => {
                    const imgWrapper = document.createElement('div');
                    imgWrapper.classList.add('img-wrapper', 'd-flex', 'flex-column', 'align-items-center');
                    imgWrapper.dataset.imageId = image.id; // –î–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

                    const img = document.createElement('img');
                    img.src = `/images/${image.id}`; // –ò—Å–ø–æ–ª—å–∑—É–µ–º ImageController –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    img.classList.add('image-preview');
                    img.alt = image.originalFileName;

                    const buttonsDiv = document.createElement('div');
                    buttonsDiv.classList.add('buttons-container');

                    const setPreviewBtn = document.createElement('button');
                    setPreviewBtn.classList.add('btn', 'btn-sm', 'btn-info', 'me-1', 'set-preview-btn');
                    setPreviewBtn.innerHTML = image.isPreviewImage ? '‚≠ê –ü—Ä–µ–≤—å—é' : '–°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–≤—å—é';
                    setPreviewBtn.disabled = image.isPreviewImage;
                    setPreviewBtn.dataset.productId = product.id;
                    setPreviewBtn.dataset.imageId = image.id;

                    const deleteImgBtn = document.createElement('button');
                    deleteImgBtn.classList.add('btn', 'btn-sm', 'btn-danger', 'delete-image-btn');
                    deleteImgBtn.innerHTML = 'üóëÔ∏è –£–¥–∞–ª–∏—Ç—å';
                    deleteImgBtn.dataset.productId = product.id;
                    deleteImgBtn.dataset.imageId = image.id;

                    buttonsDiv.appendChild(setPreviewBtn);
                    buttonsDiv.appendChild(deleteImgBtn);

                    imgWrapper.appendChild(img);
                    imgWrapper.appendChild(buttonsDiv);
                    existingImagesContainer.appendChild(imgWrapper);
                });
            } else {
                existingImagesContainer.innerHTML = '<p class="text-muted">–£ —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π.</p>';
            }

            editModal.show();
        } catch (error) {
            showMessage(error.message, 'danger');
        }
    }

    function previewEditImages(event) {
        const previewContainer = document.getElementById('image-preview-container-edit');
        previewContainer.innerHTML = '';
        if (this.files) {
            Array.from(this.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.classList.add('image-preview');
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        }
    }

    async function submitEditForm() {
        const productId = document.getElementById('edit-productId').value;
        const formData = new FormData();
        const product = {
            name: document.getElementById('edit-name').value,
            articleNumber: document.getElementById('edit-articleNumber').value,
            price: parseFloat(document.getElementById('edit-price').value),
            quantity: parseInt(document.getElementById('edit-quantity').value),
            brand: document.getElementById('edit-brand').value,
            category: document.getElementById('edit-category').value,
            manufacturer: document.getElementById('edit-manufacturer').value,
            carBrand: document.getElementById('edit-carBrand').value,
            description: document.getElementById('edit-description').value,
            inStock: document.getElementById('edit-inStock').checked
        };
        formData.append('product', new Blob([JSON.stringify(product)], { type: "application/json" }));

        const fileInput = document.getElementById('edit-files');
        if (fileInput.files.length > 0) {
            for (const file of fileInput.files) {
                formData.append('files', file);
            }
        }

        try {
            const response = await fetch(`/api/products/${productId}`, {
                method: 'PUT',
                body: formData
            });
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞.');
            }

            editModal.hide();
            showMessage('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!');
            fetchProducts(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
        } catch (error) {
            showMessage(error.message, 'danger');
        }
    }

    // ----- –õ–û–ì–ò–ö–ê –£–î–ê–õ–ï–ù–ò–Ø -----
    async function handleDelete(id) {
        if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä —Å ID ${id}?`)) {
            return;
        }

        try {
            const response = await fetch(`/api/products/${id}`, {
                method: 'DELETE'
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä.');
            }

            showMessage(`–¢–æ–≤–∞—Ä —Å ID ${id} —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.`);
            fetchProducts(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É

        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
            showMessage(error.message, 'danger');
        }
    }
</script>
</body>
</html>